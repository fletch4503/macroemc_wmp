{% load partials %}
<!-- Таблица -->
<div class="overflow-x-auto" id="wp-list">
{% partialdef wp-list inline %}
    <table class="table w-full" id="workplaces-table">
        <thead>
            <tr>
                <th>Наименование</th>
                <th>Описание</th>
                <th>Тип</th>
                <th>Отдел</th>
                <th>IP</th>
                <th>MAC</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% partialdef wp-tbody inline %}
                {% for wp in workplaces %}
                    {% include "workplaces/partials/wp_row.html" %}
                {% empty %}
                    <tr><td colspan="6" class="text-center">Нет доступных элементов</td></tr>
                {% endfor %}
            {% endpartialdef wp-tbody %}
            {% for wp in workplaces %}
            {% endfor %}
        </tbody>
    </table>
{% endpartialdef wp-list %}
</div>
<script>
    // JS для показа/скрытия ip/mac
    document.getElementById('id_type').addEventListener('change', function() {
        const type = this.value;
        const ipField = document.getElementById('ip-field');
        const macField = document.getElementById('mac-field');
        if (type === 'pcplace') {
            ipField.classList.remove('hidden');
            macField.classList.remove('hidden');
        } else {
            ipField.classList.add('hidden');
            macField.classList.add('hidden');
        }
    });

    // Функция для inline edit
    function editWorkplace(button) {
        const row = button.closest('tr');
        const url = button.dataset.url;
        htmx.ajax('GET', url, {target: #wp_form, swap: 'innerHTML'});
    }

    document.body.addEventListener('replace-row', function(event) {
    const detail = event.detail;
    const rowElement = document.getElementById('wp-' + detail.pk);
    if (rowElement) {
        rowElement.outerHTML = detail.html;
    }
});

</script>